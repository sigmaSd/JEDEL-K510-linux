#!/bin/bash

function switch {
	modifier="$((! modifier))"
}

device=`sudo libinput list-devices | rg -A 1 'USB USB Keyboard$' | rg -o 'event[0-9]*'`
input=`fd $device /sys/devices  | rg -o 'input[0-9]+'`

echo All set.

current_state=`cat /sys/class/leds/$input::scrolllock/brightness`
modifier="$((! current_state))"

while true
do

sudo unbuffer showkey | rg --line-buffered '70 press' |
 xargs  -i 	echo $modifier | sudo tee /sys/class/leds/$input::scrolllock/brightness |
 xargs -i sudo pkill showkey
 switch
done
